<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../img/logo.ico">
    <title>BookRecSys | Item</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        #navbar {
            height: 64px;
        }

        #navbar-logo {
            width: 20%;
        }

        #navbar-search {
            width: 60%;
        }

        #div-dashboard {
            width: 10%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #div-cart {
            width: 10%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #div-customer-dropdown {
            width: 10%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .no-style-a,
        .no-style-a:hover,
        .no-style-a:focus,
        .no-style-a:active {
            text-decoration: none;
            color: inherit;
        }

        #item-img-card {
            border: 0px;
            width: 288px;
            height: 450px;
            margin-right: 32px;
        }

        #card-footer {
            margin-top: auto;
        }

        .similar-item {
            width: 160px;
            height: 325px;
            border-radius: 4px;
            background: #fff;
            box-shadow: 0 6px 10px rgba(0, 0, 0, .08), 0 0 6px rgba(0, 0, 0, .05);
            transition: .3s transform cubic-bezier(.155, 1.105, .295, 1.12), .3s box-shadow, .3s -webkit-transform cubic-bezier(.155, 1.105, .295, 1.12);
            cursor: pointer;
        }

        .card-body {
            overflow: auto;
            height: 250px;
        }

        .similar-item:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, .12), 0 4px 8px rgba(0, 0, 0, .06);
        }

        #similar-items-list>a>div {
            margin: 10px;
        }

        #item-card {
            width: 700px;
            height: 475px;
        }

        table {
            font-size: 14px;
        }

        p {
            font-size: 14px;
            text-align: justify;
            text-justify: inter-word;
        }

        @media screen and (max-width: 1245px) {
            #navbar-logo {
                width: 20%;
            }

            #navbar-search {
                width: 50%;
            }

            #div-dashboard {
                width: 15%;
                justify-content: end;
            }

            #div-cart {
                width: 15%;
            }

            #div-customer-dropdown {
                width: 15%;
            }

            #item-card {
                width: 500px;
                height: 600px;
            }
        }

        @media screen and (max-width: 980px) {
            #navbar {
                display: flex;
                flex-direction: column;
                height: 230px;
            }

            #navbar-logo {
                width: 100%;
                justify-content: center;
            }

            #navbar-search {
                justify-content: center;
                width: 100%;
            }

            #div-dashboard {
                width: 100%;
                justify-content: center;
            }

            #div-cart {
                width: 100%;
            }

            #div-customer-dropdown {
                width: 100%;
            }

            #input-search {
                width: 80%;
            }

            #item-container {
                flex-direction: column;
            }

            #item-card-div {
                width: 100%;
            }

            #item-card {
                width: 80%;
                height: 475px;
            }
        }
    </style>
</head>

<body>
    <div id="navbar" class="d-flex bg-dark text-white">
        <div id="navbar-logo" class="d-flex align-items-center">
            <a href="dashboard.html"><img src="../img/logo.ico" alt="logo" height="40" class="m-2"></a>
            <span style="font-size:24px; font-weight: bold;"><a href="dashboard.html"
                    class="no-style-a">BookRecSys</a></span>
        </div>
        <div id="navbar-search" class="d-flex align-items-center m-2">
            <input type="text" id="input-search" class="form-control me-2">
            <button class="btn btn-primary" id="btn-search"><i
                    class="fa-solid fa-magnifying-glass"></i></button>
        </div>
        <div id="div-dashboard" class="d-flex align-items-center">
            <button class="btn btn-dark" onclick="location.href = 'dashboard.html'"><i
                    class="fa-solid fa-clipboard-list"></i> Dashboard</button>
        </div>
        <div id="div-cart" class="d-flex align-items-center">
            <button class="btn btn-dark" onclick="location.href='cart.html'"><i class="fa-solid fa-shopping-cart"></i>
                Cart <span id = "cart-count" class="badge bg-secondary"></span></button>
        </div>
        <div id="div-customer-dropdown" class="d-flex align-items-center">
            <div class="dropdown">
                <a class="btn btn-dark dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa-solid fa-user-circle"></i> <span id = "user-name"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <li><a class="dropdown-item" href="profile.html"><i class="fa-solid fa-user"></i> My Profile</a>
                    </li>
                    <li><a class="dropdown-item" href="transactions.html"><i class="fa-solid fa-wallet"></i> My
                            Transactions</a></li>
                    <li><a class="dropdown-item" href="javascript:void(0)" id="sign-out"><i class="fa-solid fa-power-off"></i> Sign Out</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="d-flex flex-column align-items-center p-2">
        <div id="item-container" class="d-flex justify-content-center align-items-center p-2">
            <!--<div id="item-img-card" class="card">
                <div class="card-body d-flex flex-column justify-content-center">
                    <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1546103428l/5297.jpg"
                        alt="...">
                </div>
            </div>
            <div id="item-card-div" class="d-flex justify-content-center">
                <div id="item-card" class="card d-flex flex-column">
                    <div class="card-header bg-dark text-white mb-2">
                        <h2 style="text-align: center;">Classical Mythology</h2>
                    </div>
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="description-tab" data-bs-toggle="tab"
                                data-bs-target="#description" type="button" role="tab" aria-controls="description"
                                aria-selected="true">Description</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="more-information-tab" data-bs-toggle="tab"
                                data-bs-target="#more-information" type="button" role="tab"
                                aria-controls="more-information" aria-selected="false">More Information</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent" style="max-height: 260px; overflow: auto;">
                        <div class="tab-pane fade show active p-4" id="description" role="tabpanel"
                            aria-labelledby="description-tab">
                            <p>"WINNING MEANS FAME AND FORTUNE.LOSING MEANS CERTAIN DEATH.THE HUNGER GAMES HAVE BEGUN. .
                                .
                                .In the ruins of a place once known as North America lies the nation of Panem, a shining
                                Capitol surrounded by twelve outlying districts. The Capitol is harsh and cruel and
                                keeps
                                the districts in line by forcing them all to send one boy and once girl between the ages
                                of
                                twelve and eighteen to participate in the annual Hunger Games, a fight to the death on
                                live
                                TV.Sixteen-year-old Katniss Everdeen regards it as a death sentence when she steps
                                forward
                                to take her sister's place in the Games. But Katniss has been close to dead beforeâ€”and
                                survival, for her, is second nature. Without really meaning to, she becomes a contender.
                                But
                                if she is to win, she will have to start making choices that weight survival against
                                humanity and life against love."</p>
                        </div>
                        <div class="tab-pane fade p-4" id="more-information" role="tabpanel"
                            aria-labelledby="more-information-tab">
                            <table class="table table-bordered">
                                <tbody>
                                    <tr>
                                        <th>ISBN</th>
                                        <td>9780439023481</td>
                                    </tr>
                                    <tr>
                                        <th>Publisher</th>
                                        <td>Scholastic Press</td>
                                    </tr>
                                    <tr>
                                        <th>Publication Year</th>
                                        <td>2008</td>
                                    </tr>
                                    <tr>
                                        <th>Book Format</th>
                                        <td>Hardcover</td>
                                    </tr>
                                    <tr>
                                        <th>Genre</th>
                                        <td>Young Adult, Fiction, Dystopia, Fantasy, Science Fiction, Romance,
                                            Adventure,
                                            Teen, Post Apocalyptic, Action</td>
                                    </tr>
                                    <tr>
                                        <th>Author</th>
                                        <td>Suzanne Collins</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="card-footer" class="bg-body card-footer d-flex justify-content-evenly p-2">
                        <div class="d-flex flex-column align-items-center p-2">
                            <strong>In stock</strong>
                            <span>Only 10 Left</span>
                            <h4>Php 340.00</h4>
                        </div>
                        <div class="d-flex flex-column align-items-center p-2">
                            <div class="form-group row mb-3">
                                <label for="quantity" class="col-sm-4 col-form-label"><strong>Quantity:
                                    </strong></label>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="quantity" min="1" max="10"
                                        value="1">
                                </div>
                            </div>
                            <button class="btn btn-primary form-control"><i class="fa-solid fa-shopping-cart"></i> Add
                                to
                                Cart</button>
                        </div>
                    </div>
                </div>
            </div>-->
        </div>
        <div id="similar-items-container">
            <h2 style="text-align: center;" class="my-2">Similar Items</h2>
            <div id="similar-items-list" class="d-flex flex-wrap justify-content-center">
                <!--<a href="item.html" class="no-style-a">
                    <div class="card similar-item">
                        <div class="card-body d-flex flex-column justify-content-center">
                            <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1327872220l/24213.jpg"
                                alt="..." class="mb-3">
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">Classical
                                Mythology</span>
                            <span style="font-size: 10px; text-align: center;">Mark P.O. Morford</span>
                            <span style="font-size: 12px; text-align: center;">Php 300.00</span>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button class="btn btn-primary" style="font-size: 12px;"><i
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                </a>
                <a href="item.html" class="no-style-a">
                    <div class="card similar-item">
                        <div class="card-body d-flex flex-column justify-content-center">
                            <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1557343311l/10210._SY475_.jpg"
                                alt="..." class="mb-3">
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">Classical
                                Mythology</span>
                            <span style="font-size: 10px; text-align: center;">Mark P.O. Morford</span>
                            <span style="font-size: 12px; text-align: center;">Php 300.00</span>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button class="btn btn-primary" style="font-size: 12px;"><i
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                </a>
                <a href="item.html" class="no-style-a">
                    <div class="card similar-item">
                        <div class="card-body d-flex flex-column justify-content-center">
                            <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1411852091l/24280.jpg"
                                alt="..." class="mb-3">
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">Classical
                                Mythology</span>
                            <span style="font-size: 10px; text-align: center;">Mark P.O. Morford</span>
                            <span style="font-size: 12px; text-align: center;">Php 300.00</span>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button class="btn btn-primary" style="font-size: 12px;"><i
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                </a>
                <a href="item.html" class="no-style-a">
                    <div class="card similar-item">
                        <div class="card-body d-flex flex-column justify-content-center">
                            <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1383718290l/13079982.jpg"
                                alt="..." class="mb-3">
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">Classical
                                Mythology</span>
                            <span style="font-size: 10px; text-align: center;">Mark P.O. Morford</span>
                            <span style="font-size: 12px; text-align: center;">Php 300.00</span>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button class="btn btn-primary" style="font-size: 12px;"><i
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                </a>
                <a href="item.html" class="no-style-a">
                    <div class="card similar-item">
                        <div class="card-body d-flex flex-column justify-content-center">
                            <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1588455221l/13335037._SY475_.jpg"
                                alt="..." class="mb-3">
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">Classical
                                Mythology</span>
                            <span style="font-size: 10px; text-align: center;">Mark P.O. Morford</span>
                            <span style="font-size: 12px; text-align: center;">Php 300.00</span>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button class="btn btn-primary" style="font-size: 12px;"><i
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                </a>-->
            </div>
        </div>
    </div>
    <nav class="navbar bg-dark mt-4">
        <div class="container-fluid text-white d-flex justify-content-center align-items-center p-2">
            <div class="me-2"><strong>Copyright &copy; 2022</strong> All rights reserved.</div>
            <div><a href="../policy.html" class="text-secondary">Privacy Policy</a></div>
        </div>
    </nav>
    <script>
        $(document).ready(function () {

            var user = sessionStorage.getItem("user");
            if(user == null){
                window.location.replace("../index.html");
            }
            var user_JSON = JSON.parse(user);
            if(user_JSON["is_admin"] == 1){
                window.location.replace("../InvalidAccess.html");
            }        

            // load cart count
            var formData = new FormData();
            var user = JSON.parse(sessionStorage.getItem("user"));
            var user_ID = user["user_ID"];
            formData.append("GetCartCount", "set");
            formData.append("user_ID",user_ID);
            $.ajax({
                type: "POST",
                url: "GetCartCount_API.php",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    var obj = JSON.parse(data);
                    $("#cart-count").html(obj["cartCount"]);
                }
            });

            // load username in header
            var username = user["first_name"] + ' ' + user["last_name"];
            $("#user-name").html(username);

            
        });

        $("#sign-out").click(function()
		{
			// Clear Session storage and redirect to home page
			sessionStorage.clear();
			window.location.replace("../index.html");
		});

        $("#btn-search").click(function () {
            var query = $("#input-search").val();
            window.location.href = "search.html?query=" + query;
        });

        $(document).on("click", '[id^=a-href-book-]', function (event) {
            var id = this.id.match(/[0-9]+/);
            var id_index = parseInt(id[0]);

            // register click event
            var user = JSON.parse(sessionStorage.getItem("user"));
            var formData = new FormData();
            formData.append("RecordClick", "set");
            formData.append("book_ID", id_index);
            formData.append("user_ID",user["user_ID"]);
            $.ajax({
                type: "POST",
                url: "RecordClick_API.php",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    var obj = JSON.parse(data);
                    window.location.href = "item.html?book_ID=" + id_index;
                }
            });
        });

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        if (urlParams.has('book_ID')) {
            var book_ID = urlParams.get('book_ID');
            var formData = new FormData();
            formData.append("GetBookDetails", "set");
            formData.append("book_ID", book_ID);
            $.ajax({
                    type: "POST",
                    url: "GetBookDetails_API.php",
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        var obj = JSON.parse(data);
                        $("#item-container").html("");

                        var html_element = ' \
                        <div id="item-img-card" class="card"> \
                        <div class="card-body d-flex flex-column justify-content-center"> \
                            <img src="'+obj["book"]["cover_image_loc"]+'" \
                                alt="..."> \
                        </div> \
                    </div> \
                    <div id="item-card-div" class="d-flex justify-content-center"> \
                        <div id="item-card" class="card d-flex flex-column"> \
                            <div class="card-header bg-dark text-white mb-2"> \
                                <h2 style="text-align: center;">'+obj["book"]["title"]+'</h2> \
                            </div> \
                            <ul class="nav nav-tabs" id="myTab" role="tablist"> \
                                <li class="nav-item" role="presentation"> \
                                    <button class="nav-link active" id="description-tab" data-bs-toggle="tab" \
                                        data-bs-target="#description" type="button" role="tab" aria-controls="description" \
                                        aria-selected="true">Description</button> \
                                </li> \
                                <li class="nav-item" role="presentation"> \
                                    <button class="nav-link" id="more-information-tab" data-bs-toggle="tab" \
                                        data-bs-target="#more-information" type="button" role="tab" \
                                        aria-controls="more-information" aria-selected="false">More Information</button> \
                                </li> \
                            </ul> \
                            <div class="tab-content" id="myTabContent" style="max-height: 260px; overflow: auto;"> \
                                <div class="tab-pane fade show active p-4" id="description" role="tabpanel" \
                                    aria-labelledby="description-tab"> \
                                    <p>'+obj["book"]["description"]+'</p> \
                                </div> \
                                <div class="tab-pane fade p-4" id="more-information" role="tabpanel" \
                                    aria-labelledby="more-information-tab"> \
                                    <table class="table table-bordered"> \
                                        <tbody> \
                                            <tr> \
                                                <th>ISBN</th> \
                                                    <td>'+obj["book"]["ISBN"]+'</td> \
                                                </tr> \
                                                <tr> \
                                                    <th>Publisher</th> \
                                                    <td>'+obj["book"]["publisher_name"]+'</td> \
                                                </tr> \
                                                <tr> \
                                                    <th>Publication Year</th> \
                                                    <td>'+obj["book"]["publication_year"]+'</td> \
                                                </tr> \
                                                <tr> \
                                                    <th>Book Format</th> \
                                                    <td>'+obj["book"]["format_name"]+'</td> \
                                                </tr> \
                                                <tr> \
                                                    <th>Genre</th> \
                                                    <td>'+obj["book"]["genre"]+'</td> \
                                                </tr> \
                                                <tr> \
                                                    <th>Author</th> \
                                                    <td>'+obj["book"]["author"]+'</td> \
                                                </tr> \
                                        </tbody> \
                                    </table> \
                                </div> \
                            </div> \
                            <div id="card-footer" class="bg-body card-footer d-flex justify-content-evenly p-2"> \
                                <div class="d-flex flex-column align-items-center p-2"> \
                                    <strong>'+obj["book"]["in_stock"]+'</strong> \
                                    <span>'+obj["book"]["stock_count_text"]+'</span> \
                                    <h4>Php '+obj["book"]["price"]+'</h4> \
                                </div> \
                                <div class="d-flex flex-column align-items-center p-2"> \
                                    <div class="form-group row mb-3"> \
                                        <label for="quantity" class="col-sm-4 col-form-label"><strong>Quantity: \
                                            </strong></label> \
                                        <div class="col-sm-8"> \
                                            <input type="number" class="form-control" id="quantity" min="1" max="'+obj["book"]["stock_count"]+'" \
                                                value="1"> \
                                        </div> \
                                    </div> \
                                    <button class="btn btn-primary form-control"><i class="fa-solid fa-shopping-cart"></i> Add to Cart</button> \
                                </div> \
                            </div> \
                        </div> \
                    </div> \
                        ';

                            $("#item-container").append(html_element);

                    }

                });

                var book_ID = urlParams.get('book_ID');
                var formData = new FormData();
                formData.append("GetSimilarItems", "set");
                formData.append("book_ID", book_ID);

                $.ajax({
                    type: "POST",
                    url: "GetSimilarItems_API.php",
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        var obj = JSON.parse(data);
                        $("#similar-items-list").html("");
                        for (i = 0, len = obj["books"].length; i < len; i++) {
                            
                            var html_element=' \
                            <a href="javascript:void(0)" id = "a-href-book-' +obj["books"][i]["book_ID"] + '" class="no-style-a"> \
                    <div class="card similar-item"> \
                        <div class="card-body d-flex flex-column justify-content-center"> \
                            <img src="'+obj["books"][i]["cover_image_loc"]+'" \
                                alt="..." class="mb-3"> \
                            <span style="font-weight: bold; font-size: 12px; text-align: center;">'+obj["books"][i]["title"]+'</span> \
                            <span style="font-size: 10px; text-align: center;">'+obj["books"][i]["author_name"]+'</span> \
                            <span style="font-size: 12px; text-align: center;">Php '+obj["books"][i]["price"]+'</span> \
                        </div> \
                        <div class="d-flex justify-content-center mb-2"> \
                            <button class="btn btn-primary" style="font-size: 12px;"><i \
                                    class="fa-solid fa-shopping-cart"></i> Add to Cart</button> \
                        </div> \
                    </div> \
                </a> \
                            ';
                            $("#similar-items-list").append(html_element);
                        }
                    }
                });
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>
</body>

</html>