<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../img/logo.ico">
    <title>BookRecSys | Items</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        .no-style-a,
        .no-style-a:hover,
        .no-style-a:focus,
        .no-style-a:active {
            text-decoration: none;
            color: inherit;
        }

        #navbar {
            height: 64px;
        }

        #navbar-logo {
            width: 20%;
        }

        #navbar-links {
            width: 60%;

        }

        #div-admin-dropdown {
            width: 20%;
            justify-content: right;
        }

        #left-container {
            width: 40%;
        }

        #right-container {
            width: 60%;
        }

        @media screen and (max-width: 970px) {
            #navbar {
                height: 260px;
                flex-direction: column;
            }

            #navbar-logo {
                width: 100%;
                justify-content: center;
            }

            #navbar-links {
                width: 100%;
                flex-direction: column;
            }

            #div-admin-dropdown {
                width: 100%;
                justify-content: center;
            }

            #main-container {
                flex-direction: column;
            }

            #left-container {
                width: 100%;
            }

            #right-container {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div id="navbar" class="d-flex bg-dark text-white">
        <div id="navbar-logo" class="d-flex align-items-center">
            <a href="dashboard.html"><img src="../img/logo.ico" alt="logo" height="40" class="m-2"></a>
            <span style="font-size:24px; font-weight: bold;"><a href="dashboard.html"
                    class="no-style-a">BookRecSys</a></span>
        </div>
        <div id="navbar-links" class="d-flex align-items-center">
            <button class="btn btn-dark me-2" onclick="location.href='dashboard.html'"><i
                    class="fa-solid fa-clipboard-list"></i> Dashboard</button>
            <button class="btn btn-dark me-2" onclick="location.href='items.html'"><i class="fa-solid fa-book-open"></i>
                Items</button>
            <button class="btn btn-dark me-2" onclick="location.href='transactions.html'"><i
                    class="fa-solid fa-wallet"></i>
                Transactions</button>
            <button class="btn btn-dark" onclick="location.href='announcements.html'"><i
                    class="fa-solid fa-exclamation-circle"></i> Announcements</button>
        </div>
        <div id="div-admin-dropdown" class="d-flex align-items-center">
            <div class="dropdown">
                <a class="btn btn-dark dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa-solid fa-user-circle"></i> <span id="div-admin-name"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <li><a class="dropdown-item" href="profile.html"><i class="fa-solid fa-user"></i> My Profile</a>
                    </li>
                    <li><a class="dropdown-item" href="../index.html"><i class="fa-solid fa-power-off"></i> Sign Out</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="div-alert">

        </div>
    </div>
    <div class="d-flex justify-content-center my-2">
        <h1>Manage Items</h1>
    </div>
    <div id="main-container" class="d-flex">
        <div class="container">
            <div class="row">
                <div class="col-sm-2" style="text-align: center;">
                    <button class="btn btn-lg btn-success m-2" data-bs-toggle="modal"
                        data-bs-target="#add-book-modal"><i class="fa-solid fa-plus"></i> Add Book</button>
                </div>
                <div class="col-sm-9 col-10">
                    <input type="text" class="form-control m-2">
                </div>
                <div class="col-sm-1 col-2">
                    <button class="btn btn-primary m-2"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>
            </div>
            <div class="row">
                <div class="table-responsive mt-4">
                    <table class="table table-bordered table-striped table-hover">
                        <thead>
                            <tr>
                                <th>Cover</th>
                                <th>Title</th>
                                <th>Publisher</th>
                                <th>Price</th>
                                <th>Stock Qty</th>
                                <th>View</th>
                                <th>Edit</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474154022l/3._SY475_.jpg"
                                        height="100" alt=""></td>
                                <td>Harry Potter and the Sorcerer's Stone</td>
                                <td>Bloomsbury (UK)</td>
                                <td>Php 310.00</td>
                                <td>15</td>
                                <td><button class="btn btn-primary"><i class="fa-solid fa-eye"></i></button></td>
                                <td><button class="btn btn-warning" data-bs-toggle="modal"
                                        data-bs-target="#edit-book-modal"><i class="fa-solid fa-pencil"></i></button>
                                </td>
                                <td><button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button></td>
                            </tr>
                            <tr>
                                <td><img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474154022l/3._SY475_.jpg"
                                        height="100" alt=""></td>
                                <td>Harry Potter and the Sorcerer's Stone</td>
                                <td>Bloomsbury (UK)</td>
                                <td>Php 310.00</td>
                                <td>15</td>
                                <td><button class="btn btn-primary"><i class="fa-solid fa-eye"></i></button></td>
                                <td><button class="btn btn-warning" data-bs-toggle="modal"
                                        data-bs-target="#edit-book-modal"><i class="fa-solid fa-pencil"></i></button>
                                </td>
                                <td><button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button></td>
                            </tr>
                            <tr>
                                <td><img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474154022l/3._SY475_.jpg"
                                        height="100" alt=""></td>
                                <td>Harry Potter and the Sorcerer's Stone</td>
                                <td>Bloomsbury (UK)</td>
                                <td>Php 310.00</td>
                                <td>15</td>
                                <td><button class="btn btn-primary"><i class="fa-solid fa-eye"></i></button></td>
                                <td><button class="btn btn-warning" data-bs-toggle="modal"
                                        data-bs-target="#edit-book-modal"><i class="fa-solid fa-pencil"></i></button>
                                </td>
                                <td><button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div id="add-book-modal" class="modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Book</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="javascript:void(0);">
                        <div class="row mb-3">
                            <label for="title" class="col-sm-3 col-form-label"><span class="text-danger">*</span><b>
                                    Title:</b></label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="title">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="isbn" class="col-sm-3 col-form-label"><b>ISBN:</b></label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="isbn" minlength="10" maxlength="13">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="price" class="col-sm-3 col-form-label"><span class="text-danger">*</span><b>
                                    Price (in Php):</b></label>
                            <div class="col-sm-9">
                                <input type="number" min="1" step=".01" class="form-control" id="price">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="publisher2" class="col-sm-3 col-form-label"><span
                                    class="text-danger">*</span><b> Publisher:</b></label>
                            <div class="col-sm-9">
                                <input class="form-control" list="publisher" name="publisher" id="publisher2">
                                <datalist id="publisher">
                                </datalist>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="publication-year" class="col-sm-3 col-form-label"><span
                                    class="text-danger">*</span><b> Publication
                                    Year:</b></label>
                            <div class="col-sm-9">
                                <input type="number" class="form-control" id="publication_year" min="1" max="9999">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="format" class="col-sm-3 col-form-label"><span class="text-danger">*</span><b>
                                    Format:</b></label>
                            <div class="col-sm-9">
                                <input class="form-control" list="format" name="format" id="format2">
                                <datalist id="format">
                                </datalist>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="description" class="col-sm-3 col-form-label"><b>Description:</b></label>
                            <div class="col-sm-9">
                                <textarea name="" class="form-control" id="description"></textarea>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="cover-image" class="col-sm-3 col-form-label"><span
                                    class="text-danger">*</span><b> Cover Image:</b></label>
                            <div class="col-sm-9" style="text-align: center;">
                                <img id="output" src="https://via.placeholder.com/130x200" width="130" height="200"
                                    alt="">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="cover-image" class="col-sm-3 col-form-label"><b>Image Selector:</b></label>
                            <div class="col-sm-9" style="text-align: center;">
                                <input type="file" id="cover_img_loc" name="img" accept="image/*"
                                    onchange="loadFile(event)">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="stock-qty" class="col-sm-3 col-form-label"><span class="text-danger">*</span><b>
                                    Stock Qty:</b></label>
                            <div class="col-sm-9">
                                <input type="number" class="form-control" id="stock_qty" min="1">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="category2" class="col-sm-3 col-form-label"><b>Category:</b></label>
                            <div class="col-sm-9">
                                <input class="form-control" list="category" name="category" id="category2">
                                <datalist id="category">
                                </datalist>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="author" class="col-sm-3 col-form-label"><b>Author(s):</b></label>
                            <div class="col-sm-9">
                                <button class="btn btn-success" id="add-author"><i
                                        class="fa-solid fa-plus"></i></button>
                            </div>
                        </div>
                        <div id="authors">
                            <div class="row mb-3" id="div-author-1">
                                <label id="label-author-1" class="col-3 col-form-label"><span
                                        class="text-danger">*</span> Author 1:</label>
                                <div class="col-7">
                                    <input type="text" class="form-control" id="author-1">
                                </div>
                                <div class="col-2">
                                    <button class="btn btn-danger" id="delete-author-1" disabled><i
                                            class="fa-solid fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="genre" class="col-sm-3 col-form-label"><b>Genre(s):</b></label>
                            <div class="col-sm-9">
                                <button class="btn btn-success" id="add-genre"><i class="fa-solid fa-plus"></i></button>
                            </div>
                        </div>
                        <div id="genres">
                            <div class="row mb-3" id="div-genre-1">
                                <label id="label-genre-1" class="col-3 col-form-label"><span
                                        class="text-danger">*</span> Genre 1:</label>
                                <div class="col-7">
                                    <input type="text" class="form-control" id="genre-1">
                                </div>
                                <div class="col-2">
                                    <button class="btn btn-danger" id="delete-genre-1" disabled><i
                                            class="fa-solid fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer d-flex flex-column">
                    <div id="alert-add-book">
                    </div>
                    <button type="button" class="btn btn-primary" id="insert-book"><i class="fa-solid fa-plus"></i>
                        Insert Book</button>
                </div>
            </div>
        </div>
    </div>
    <!--
    <div id="edit-book-modal" class="modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Book</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="javascript:void(0);">
                        <div class="row mb-3">
                            <label for="title" class="col-sm-3 col-form-label"><b>Title:</b></label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="title" value="Harry Potter">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="isbn" class="col-sm-3 col-form-label"><b>ISBN:</b></label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="isbn" value="9876543210123">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="price" class="col-sm-3 col-form-label"><b>Price (in Php):</b></label>
                            <div class="col-sm-9">
                                <input type="number" min="1" class="form-control" id="price" value="230.50">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="publisher2" class="col-sm-3 col-form-label"><b>Publisher:</b></label>
                            <div class="col-sm-9">
                                <input class="form-control" list="publisher" name="publisher" id="publisher2"
                                    value="Bloomberg Publishing">
                                <datalist id="edit-publisher">
                                    <option value="Internet Explorer">
                                    <option value="Firefox">
                                    <option value="Chrome">
                                    <option value="Opera">
                                    <option value="Safari">
                                </datalist>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="publication-year" class="col-sm-3 col-form-label"><b>Publication
                                    Year:</b></label>
                            <div class="col-sm-9">
                                <input type="number" class="form-control" id="publication-year" value="1999">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="format" class="col-sm-3 col-form-label"><b>Format:</b></label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="format" value="Paperback">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="description" class="col-sm-3 col-form-label"><b>Description:</b></label>
                            <div class="col-sm-9">
                                <textarea name="" class="form-control" id="description"
                                    value="Harry Potter and the Philosopher's Stone is a fantasy novel written by British author J. K. Rowling. The first novel in the Harry Potter series and Rowling's debut novel, it follows Harry Potter, a young wizard who discovers his magical heritage on his eleventh birthday, when he receives a letter of acceptance to Hogwarts School of Witchcraft and Wizardry. Harry makes close friends and a few enemies during his first year at the school and with the help of his friends, he faces an attempted comeback by the dark wizard Lord Voldemort, who killed Harry's parents, but failed to kill Harry when he was just 15 months old. "></textarea>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="cover-image" class="col-sm-3 col-form-label"><b>Cover Image:</b></label>
                            <div class="col-sm-9" style="text-align: center;">
                                <img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474154022l/3._SY475_.jpg"
                                    width="130" height="200" alt="">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="cover-image" class="col-sm-3 col-form-label"><b>Image Selector:</b></label>
                            <div class="col-sm-9" style="text-align: center;">
                                <input type="file" id="cover-image" name="img" accept="image/*">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="stock-qty" class="col-sm-3 col-form-label"><b>Stock Qty:</b></label>
                            <div class="col-sm-9">
                                <input type="number" class="form-control" id="stock-qty" value="23">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="category2" class="col-sm-3 col-form-label"><b>Category:</b></label>
                            <div class="col-sm-9">
                                <input class="form-control" list="category" name="category" id="category2">
                                <datalist id="category">
                                    <option value="Internet Explorer">
                                    <option value="Firefox">
                                    <option value="Chrome">
                                    <option value="Opera">
                                    <option value="Safari">
                                </datalist>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="author" class="col-sm-3 col-form-label"><b>Author(s):</b></label>
                            <div class="col-sm-9">
                                <button class="btn btn-success" id="edit-add-author"><i
                                        class="fa-solid fa-plus"></i></button>
                            </div>
                        </div>
                        <div id="edit-authors">
                            <div class="row mb-3">
                                <label for="author-1" class="col-3 col-form-label">Author 1:</label>
                                <div class="col-7">
                                    <input type="text" class="form-control" id="author-1">
                                </div>
                                <div class="col-2">
                                    <button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label for="author-2" class="col-3 col-form-label">Author 2:</label>
                                <div class="col-7">
                                    <input type="text" class="form-control" id="author-2">
                                </div>
                                <div class="col-2">
                                    <button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="genre" class="col-sm-3 col-form-label"><b>Genre(s):</b></label>
                            <div class="col-sm-9">
                                <button class="btn btn-success" id="add-genre"><i class="fa-solid fa-plus"></i></button>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="genre-1" class="col-3 col-form-label">Genre 1:</label>
                            <div class="col-7">
                                <input type="text" class="form-control" id="genre-1">
                            </div>
                            <div class="col-2">
                                <button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="genre-2" class="col-3 col-form-label">Genre 2:</label>
                            <div class="col-7">
                                <input type="text" class="form-control" id="genre-2">
                            </div>
                            <div class="col-2">
                                <button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary"><i class="fa-solid fa-plus"></i> Insert Book</button>
                </div>
            </div>
        </div>
    </div> -->
    <script>
        var loadFile = function (event) {
            var image = document.getElementById('output');
            image.src = URL.createObjectURL(event.target.files[0]);
        };

        $(document).ready(function () {
            // Check if user is logged in
            if (sessionStorage.getItem("user") === null) {
                window.location.replace("../InvalidAccess.html");
            }
            // Load company data on the profile page
            var user = JSON.parse(sessionStorage.getItem("user"));

            // Check Account Type
            if (user["is_admin"] == false) {
                window.location.replace("../InvalidAccess.html");
            }
            // Load user name on header
            $("#div-admin-name").html("Admin " + user["first_name"] + " " + user["last_name"]);

            // Load all publishers on add book modal datalist
            var formData = new FormData();
            formData.append("GetPublishers", "set");

            $.ajax({
                type: "POST",
                url: "GetPublishers_API.php",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    var obj = JSON.parse(data);
                    for (var i = 0; i < obj["publishers"].length; i++) {
                        $("#publisher").append("<option value='" + obj["publishers"][i]["publisher_name"] + "'>");
                    }
                }
            });

            // Load all formats on add book modal datalist
            var formData = new FormData();
            formData.append("GetFormats", "set");

            $.ajax({
                type: "POST",
                url: "GetFormats_API.php",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    var obj = JSON.parse(data);
                    for (var i = 0; i < obj["formats"].length; i++) {
                        $("#format").append("<option value='" + obj["formats"][i]["format_name"] + "'>");
                    }
                }
            });

            // Load all categories on add book modal datalist
            var formData = new FormData();
            formData.append("GetCategories", "set");

            $.ajax({
                type: "POST",
                url: "GetCategories_API.php",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    var obj = JSON.parse(data);
                    for (var i = 0; i < obj["categories"].length; i++) {
                        $("#category").append("<option value='" + obj["categories"][i]["category_name"] + "'>");
                    }
                }
            });
        });
        var author_count = 1;
        $("#add-author").click(function () {
            author_count++;
            var html_element = ' \
            <div class="row mb-3" id="div-author-'+ author_count + '"> \
                <label id = "label-author-'+ author_count + '" class="col-3 col-form-label">Author ' + author_count + ':</label> \
                <div class="col-7"> \
                    <input type="text" class="form-control" id="author-'+ author_count + '"> \
                </div> \
                <div class="col-2"> \
                    <button class="btn btn-danger" id="delete-author-'+ author_count + '"><i class="fa-solid fa-trash"></i></button> \
                </div> \
            </div> \
                ';
            $("#authors").append(html_element);
        });
        $(document).on("click", '[id^=delete-author]', function (event) {
            var id = this.id.match(/[0-9]+/);
            var id_index = parseInt(id[0]);
            $("#div-author-" + id_index).remove();

            // Adjust label and ids of succeeding elements
            for (var i = id_index; i < author_count; i++) {
                $("#label-author-" + (i + 1)).html("Author " + i + ":");
                $("#label-author-" + (i + 1)).attr("id", "label-author-" + i);
                $("#author-" + (i + 1)).attr("id", "author-" + i);
                $("#delete-author-" + (i + 1)).attr("id", "delete-author-" + i);
                $("#div-author-" + (i + 1)).attr("id", "div-author-" + i);
            }
            author_count--;
        });

        var genre_count = 1;
        $("#add-genre").click(function () {
            genre_count++;
            var html_element = ' \
            <div class="row mb-3" id="div-genre-'+ genre_count + '"> \
                <label id = "label-genre-'+ genre_count + '" class="col-3 col-form-label">Genre ' + genre_count + ':</label> \
                <div class="col-7"> \
                    <input type="text" class="form-control" id="genre-'+ genre_count + '"> \
                </div> \
                <div class="col-2"> \
                    <button class="btn btn-danger" id="delete-genre-'+ genre_count + '"><i class="fa-solid fa-trash"></i></button> \
                </div> \
            </div> \
                ';
            $("#genres").append(html_element);
        });
        $(document).on("click", '[id^=delete-genre]', function (event) {
            var id = this.id.match(/[0-9]+/);
            var id_index = parseInt(id[0]);
            $("#div-genre-" + id_index).remove();

            // Adjust label and ids of succeeding elements
            for (var i = id_index; i < genre_count; i++) {
                $("#label-genre-" + (i + 1)).html("Genre " + i + ":");
                $("#label-genre-" + (i + 1)).attr("id", "label-genre-" + i);
                $("#genre-" + (i + 1)).attr("id", "genre-" + i);
                $("#delete-genre-" + (i + 1)).attr("id", "delete-genre-" + i);
                $("#div-genre-" + (i + 1)).attr("id", "div-genre-" + i);
            }
            genre_count--;
        });

        $("#insert-book").click(function () {
            // 1. Validate Required Fields
            var title = $("#title").val();
            var price = $("#price").val();
            var publisher = $("#publisher2").val();
            var publication_year = $("#publication_year").val();
            var format = $("#format2").val();
            var cover_img_loc = $("#cover_img_loc").val();
            var image = $('#cover_img_loc').prop('files')[0];
            var hasImage = ($('#cover_img_loc').get(0).files.length === 0) ? "false" : "true";
            var stock_qty = $("#stock_qty").val();
            var author_1 = $("#author-1").val();
            var genre_1 = $("#genre-1").val();

            if (title && price && publisher && publication_year && format && cover_img_loc && stock_qty && author_1 && genre_1) {
                // Check if price is between .01 to 99999.99
                var float_price = parseFloat(price);
                if (float_price == NaN || (float_price < .01 || float_price > 99999.99)) {
                    var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        Please enter a valid price between .01 and 99999.99. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                    ';
                    $("#alert-add-book").html(html_element);
                    return;
                }

                // Check if publication year is between 1 and 9999.
                var int_publication_year = parseInt(publication_year);
                if (int_publication_year == NaN || (int_publication_year < 1 || int_publication_year > 9999)) {
                    var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        Please enter a valid publication year between 1 and the current year. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                    ';
                    $("#alert-add-book").html(html_element);
                    return;
                }

                // Check if stock qty is between 1 and 99999999999.
                var int_stock_qty = parseInt(stock_qty);
                if (int_stock_qty == NaN || (int_stock_qty < 1 || int_stock_qty > 99999999999)) {
                    var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        Please enter a valid stock qty value between 1 and 99999999999. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                    ';
                    $("#alert-add-book").html(html_element);
                    return;
                }

                // Check if cover image has a valid file extension
                let img_regex = /(.*?)\.(tiff|pjp|jfif|gif|svg|bmp|png|jpeg|svgz|jpg|webp|ico|xbm|dib|tif|pjpeg|avif)$/;
                if (!img_regex.test(cover_img_loc)) {
                    var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        Please enter an image with a different file extension. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                    ';
                    $("#alert-add-book").html(html_element);
                    return;
                }

                // OPTIONAL FIELDS 
                var description = $("#description").val();
                var category = $("#category2").val();
                var isbn = $("#isbn").val();

                // 1. Check if ISBN is a 10 or 13 digit code
                let isbn10 = /^\d{10}$/;
                let isbn13 = /^\d{13}$/;

                if (!isbn10.test(isbn) && !isbn13.test(isbn) && isbn) {
                    var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        ISBN must be a 10-digit code, 13-digit code, or null value. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                    ';
                    $("#alert-add-book").html(html_element);
                    return;
                }

                // CALL API TO INSERT BOOK

                var formData = new FormData();
                formData.append("InsertBook", "set");
                formData.append("title", title);
                formData.append("price", price);
                formData.append("publisher", publisher);
                formData.append("publication_year", publication_year);
                formData.append("format", format);
                formData.append("image", image);
                formData.append("stock_qty", stock_qty);
                formData.append("description", description);
                formData.append("category", category);
                formData.append("isbn", isbn);

                // load all authors and genres
                for (var i = 1; i <= author_count; i++) {
                    formData.append('author[]', $("#author-" + i).val());
                }
                for (var i = 1; i <= genre_count; i++) {
                    formData.append('genre[]', $("#genre-" + i).val());
                }

                $.ajax({
                    type: "POST",
                    url: "InsertBook_API.php",
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        var obj = JSON.parse(data);
                        console.log(obj);
                        if (obj["error"] == 1) {
                            var html_element = ' \
                                <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                                    '+obj["response"]+' \
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                                </div> \
                            ';
                            $("#alert-add-book").html(html_element);
                        }
                        else if(obj["error"] == 0){
                            var html_element = ' \
                                <div class="alert alert-success alert-dismissible fade show m-2" role="alert"> \
                                    '+obj["response"]+' \
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                                </div> \
                            ';
                            $("#div-alert").html(html_element);
                            $("#add-book-modal .btn-close").click();

                            // Reset Modal Content
                            $("#title").val("");
                            $("#isbn").val("");
                            $("#price").val("");
                            $("#publisher2").val("");
                            $("#publication_year").val("");
                            $("#format2").val("");
                            $("#description").val("");
                            $("#output").attr("src","https://via.placeholder.com/130x200");
                            $("#cover_img_loc").val("");
                            $("#stock_qty").val("");
                            $("#category2").val("");
                            $("#author-1").val("");
                            $("#genre-1").val("");
                            for(var i = author_count; i > 1; i--){
                                $("#delete-author-"+i).click();
                            }
                            author_count = 1;
                            for(var i = genre_count; i > 1; i--){
                                $("#delete-genre-"+i).click();
                            }
                            genre_count = 1;
                        }
                    }
                });

            }
            else {
                var html_element = ' \
                    <div class="alert alert-danger alert-dismissible fade show m-2" role="alert"> \
                        Please fill out all required fields. \
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> \
                    </div> \
                ';
                $("#alert-add-book").html(html_element);
            }

        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>
</body>

</html>